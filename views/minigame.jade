doctype html
html
  head
    meta(charset='utf-8')
    title
    // <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    link(href='stylesheets\\game\\g.css' rel='stylesheet' type='text/css')
    link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css' rel='stylesheet')
    script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js')
  body(style='margin: 0px;background-color: #090707;')
    audio#vd(autoplay='')
      source(src='/neverforget.mp3' type='audio/mpeg')
      h3 遇到不支援的瀏覽器會出現這行字
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js')
    script(src='javascripts/minigame/minigame.js')
    script(src='javascripts/MainSystem/StringJsonBuilder.js')
    script.
      var count = 0, combo_num = 0, butt_sum = 0, count_back = 3;
      function getRandom(min, max) {
      console.log(max)
      return Math.floor(Math.random() * (max - min + 1)) + min;
      };
      function onload() {
      $(".content .gamearea .mypot").append('<button class=touch id=testbtn  style="width:100px;height:100px ;border-radius:50% ;border:none;z-index: 2;background-color:hotpink">')
      let offse = $(".content .gamearea .mypot #testbtn").last().offset()
      $(".content .gamearea .mypot #testbtn").last().offset({
      top: offse.top + getRandom(0, $(".content .gamearea .mypot").outerHeight() * 0.7),
      left: offse.left + getRandom(0, $(".content .gamearea .mypot").outerWidth() * 0.8)
      })
      if (combo_num != butt_sum) {
      butt_sum = 0;
      combo_num = 0;
      }
      document.getElementById("point").innerHTML = count;
      document.getElementById("comvalue").innerHTML = combo_num;
      butt_sum += 1;
      $(document).ready(function () {
      $("#testbtn").mouseenter(function () {
      document.onkeydown = keyFunction;
      function keyFunction() {
      if(event.keyCode==90 && $("#testbtn").mouseenter){
      point_fun();
      }
      if(event.keyCode==88 && $("#testbtn").mouseenter){
      point_fun();
      }
      document.onkeydown=0;
      }
      });
      });
      }
      function strat_f() {
      const butt = document.getElementById("butt");
      const butt2 = document.getElementById("butt2");
      butt.remove();
      butt2.remove();
      setTimeout(count_backwards, 0);
      setTimeout(count_backwards, 1000);
      setTimeout(count_backwards, 2000);
      setTimeout(rem_backwards, 3000);
      setTimeout(playAudio, 4000);
      }
      function count_backwards() {
      document.getElementById("count_back").innerHTML = count_back;
      count_back--;
      }
      function rem_backwards() {
      document.getElementById("count_back").remove();
      }
      function rem() {
      var img = document.getElementById("testbtn");
      img.remove();
      }
      function rem_point() {
      var img = document.getElementById("testbtn");
      img.remove();
      combo_num += 1;
      if (combo_num != butt_sum) {
      butt_sum = 0;
      combo_num = 0;
      }
      document.getElementById("comvalue").innerHTML = combo_num;
      document.getElementById("point").innerHTML = count;
      }
      function point_fun() {
      count += 1;
      rem_point();
      }
      function playAudio() {
      const audio = document.createElement("audio");
      audio.src = "stylesheets/game/neverforget.mp3";
      audio.play();//bpm 0.7666 0.383
      var high_speed = 383, low_speed = 766;
      for (var i = 0; i < 67; i++) {
      setTimeout(onload, i * low_speed);
      setTimeout(rem, i * low_speed + low_speed);//0~52
      }
      for (var i = 0; i < 56; i++) {
      setTimeout(onload, 51322 + i * high_speed);
      setTimeout(rem, 51322 + i * high_speed + high_speed);//51~1.13-21678
      }
      for (var i = 0; i < 19; i++) {
      setTimeout(onload, 72770 + i * low_speed);//1.13~1.28
      setTimeout(rem, 72770 + i * low_speed + low_speed);
      }
      audio.onended = function() {
            localStorage.setItem("score", count);
      };
      }
      function back(){
         localStorage.setItem("score", count);
         history.back()
      }
      function Rick() {
      const audio = document.createElement("audio");
      const butt = document.getElementById("butt");
      const butt2 = document.getElementById("butt2");
      audio.src = "stylesheets/game/Rick Astley .mp3";
      butt2.remove();
      butt.remove();
      audio.play();
      }

    //
      <script type="text/javascript">
      window.onload = function() {
      setInterval("toggleSound()", 100);
      }
      function toggleSound() {
      var music = document.getElementById("vd"); //獲取ID
      if (music.paused) { //判讀是否播放
      music.paused = false;
      music.play(); //沒有就播放
      }
      }
      </script>
    .content
      .Point
        .output_area
          label 分數
          // <output type="text" id="grade">顯示累加起來的分數</output>
          output#point(type='text') 0
          // 顯示累加起來的分數
        .Combo
          p#combo COMBO
          p#comvalue
        button#butt(type='button' onclick='strat_f();') 點擊開始遊戲
        button#butt2(type='button' onclick='Rick();') 好聽音樂
        input#butt3(type='button' onclick='back();' value='回到上一頁')
      .gamearea
        #Mypot.mypot
          img#img1.img1(src='img/bocchiTheRock.jpg')
        p#count_back(style='top: 300px;right: 500px;;z-index: 5;position: absolute;')
    //
      <div class="progress">
      <div class="progress-bar" role="progressbar" style="width: 15%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100"></div>
      <div class="progress-bar bg-success" role="progressbar" style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
      <div class="progress-bar bg-info" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
      <div class="progress-bar bg-warning" role="progressbar" style="width: 35%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
